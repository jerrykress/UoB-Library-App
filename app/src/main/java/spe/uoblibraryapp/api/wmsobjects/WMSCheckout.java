package spe.uoblibraryapp.api.wmsobjects;

import spe.uoblibraryapp.api.WMSException;
import spe.uoblibraryapp.api.ncip.WMSNCIPStaffService;

/**
 * This is generated by a user profile and has all the controls needed to checkout a book
 * @author rileyevans
 */
public class WMSCheckout {
    private String bookId;
    private WMSUserProfile userProfile;
    private WMSNCIPStaffService staffService;
    private Boolean rejected;
    private Boolean accepted;

    /**
     *
     * @param bookId
     * @param userProfile
     * @param staffService
     */
    public WMSCheckout(
            String bookId,
            WMSUserProfile userProfile,
            WMSNCIPStaffService staffService
    ){
        this.bookId = bookId;
        this.staffService = staffService;
        this.userProfile = userProfile;


    }

    /**
     * Exists for the UI people to get book info for a checkout
     * @return
     */
    public WMSBook getBook(){
        return new WMSBook(bookId);
    }

    /**
     * Used to accept a checkout after confirmation
     * @return this returns false if there was an error checking out the book.
     */
    public Boolean accept() throws WMSException{
        if (rejected) {
            // Wooooaaaaah! You cant accept a checkout after you've rejected it, make a new one. ðŸ¤¬
            throw new WMSException("You can't accept a checkout after it's been rejected");
        }

        this.accepted = true;
        return null;
    }

    /**
     * Used to reject a checkout after confirmation
     * Essentially invalidates this checkout.
     */
    public void reject() throws WMSException{
        if (accepted) {
            // just wait a sec and think about it... Q: can you undo a book checkout?
            // A: no you cant.
            throw new WMSException("You can't reject a checkout after it's been accepted"); // Ideally this should be throw new YouAreAnIdiotException()
        }
        this.rejected = true;
    }

}
